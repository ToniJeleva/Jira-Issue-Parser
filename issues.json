[
  {
    "summary": "On startup sourcetree consumes a lot of resources (memory)",
    "key": "SRCTREEWIN-7438",
    "uri": "https://jira.atlassian.com/rest/api/latest/issue/808507",
    "type": "Bug",
    "priority": "Highest",
    "reporterName": "duncan chiriga",
    "creationDate": "2017-06-11",
    "comments": []
  },
  {
    "summary": "JiraHostConnectionAccessor does not reuse the same connection in nested calls",
    "key": "JRASERVER-61818",
    "uri": "https://jira.atlassian.com/rest/api/latest/issue/614559",
    "type": "Bug",
    "priority": "Low",
    "description": "{panel:bgColor\u003d#e7f4fa}\n  *NOTE:* This bug report is for *JIRA Server*. Using *JIRA Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/JRACLOUD-61818].\n  {panel}\n\nI have this use case in Fusion DVCS Connector where I need to execute two DAO calls within the same transaction through _com.atlassian.pocketknife.api.querydsl.DatabaseAccessor_ (atlassian pocketknife query-dsl library) :\r\n\r\n{code}\r\n        return databaseAccessor.runInTransaction(connection -\u003e {\r\n            Message\u003cP\u003e createdMessage \u003d messageDao.create(message, tags);\r\n            requireNonNull(createdMessage.getId());\r\n\r\n            for (MessageQueueItem item : messageItems) {\r\n                messageQueueItemDao.create(item, createdMessage);\r\n            }\r\n            return createdMessage;\r\n        });\r\n{code}\r\n\r\n_messageDao.create_ and _messageQueueItemDao.create_ run the SQL within _databaseAccessor.runInTransaction_ as well, e.g. in _MessageDao_ implementation : \r\n\r\n{code}\r\n    public Message create(final Message message, final String[] tags) {\r\n        Integer id \u003d databaseAccessor.runInTransaction(connection -\u003e {\r\n             // SQL query DSL insert code goes here\r\n             return id;\r\n        });\r\n        message.setTags(tags);\r\n        message.setId(id);\r\n        return message;\r\n    }\r\n{code}\r\n\r\nProblem in the main code is that _messageDao.create_ and _messageQueueItemDao.create_ run with different connections and therefore NOT in the same transaction as expected. \r\n\r\nDigging out deeper, _databaseAccessor.runInTransaction_ calls _JiraHostConnectionAccessor.execute(false, false, callback)_ which sits in JIRA SAL Plugin :\r\n\r\n{code}\r\n    public \u003cA\u003e A execute(final boolean readOnly, final boolean newTransaction, @Nonnull final ConnectionCallback\u003cA\u003e callback) {\r\n        if (newTransaction) {\r\n            // Need to borrow a connection from the pool and start a new transaction\r\n            return borrowConnectionAndExecute(readOnly, callback);\r\n        } else {\r\n            final Connection existingConnection \u003d CoreTransactionUtil.getConnection();\r\n            if (existingConnection \u003d\u003d null) {\r\n                // no current transaction in OfBiz\r\n                return borrowConnectionAndExecute(readOnly, callback);\r\n            } else {\r\n                // Developer has requested to participate in existing transaction, and OfBiz actually has one running ...\r\n                // I don\u0027t think it is a good idea to set read-only on an existing transaction ... ignoring\r\n                return executeInExistingTransaction(callback, existingConnection);\r\n            }\r\n        }\r\n    }\r\n\r\n    private \u003cA\u003e A borrowConnectionAndExecute(final boolean readOnly, final ConnectionCallback\u003cA\u003e callback) {\r\n        return databaseAccessor.executeQuery(connection -\u003e {\r\n                    // By contract must run in a Transaction\r\n                    connection.setAutoCommit(false);\r\n                    try {\r\n                        connection.getJdbcConnection().setReadOnly(readOnly);\r\n                    } catch (SQLException e) {\r\n                        throw new DataAccessException(e);\r\n                    }\r\n                    // If this returns successfully then SAL\u0027s DefaultTransactionalExecutor will commit the transaction\r\n                    // If it throws RuntimeException then DatabaseAcccessor and DefaultTransactionalExecutor will both\r\n                    // cause a rollback() ... seems harmless.\r\n                    try {\r\n                        return callback.execute(connection.getJdbcConnection());\r\n                    } finally {\r\n                        if (readOnly) {\r\n                            // Need to return the connection to the default state of NOT read-only.\r\n                            try {\r\n                                connection.getJdbcConnection().setReadOnly(false);\r\n                            } catch (SQLException ex) {\r\n                                log.error(\"Unable to unset the read-only flag on a borrowed DB Connection ... chaos will ensue.\", ex);\r\n                            }\r\n                        }\r\n                        // Connection Pool will set default auto-commit mode\r\n                    }\r\n                }\r\n        );\r\n    }\r\n{code}\r\n\r\nThe nested call does not reuse the same connection because _CoreTransactionUtil.getConnection_ tries to get \"existing\" connection from a _ThreadLocal_ variable but _borrowConnectionAndExecute_ code does not put any connection in the _ThreadLocal_ for further re-use.\r\n\r\nI resolved this problem in my code by passing the connection to both DAOs methods.\r\n\r\nOther developers may assume _databaseAccessor.runInTransaction_ and _JiraHostConnectionAccessor.execute_ handle nested calls properly therefore if you do not intend to fix this problem please update the API documentation at least.",
    "reporterName": "Eduardo Soares",
    "creationDate": "2016-07-08",
    "comments": []
  },
  {
    "summary": "When customers are using IE or Edge, they receive the \"Something has gone wrong  Atlassian account\"",
    "key": "ID-6297",
    "uri": "https://jira.atlassian.com/rest/api/latest/issue/793074",
    "type": "Bug",
    "priority": "Low",
    "description": "h3. Summary\r\n\r\nUsers using IE 11 or Edge while having Atlassian Account enabled in their instance depending on the cookie level of security could receive \"Something has gone wrong Atlassian account\" while trying to logging in.\r\nh3. How to reproduce\r\n # User\u0027s go to their instance with AA enabled.\r\n # They are redirected to the ID portal.\r\n # They input their email and password and when they got redirected to their instance the error message appears on the screen.\r\n\r\nh3. Expected Results\r\n # Users are redirected and are able to log in without problems.\r\n\r\nh3. Actual Results\r\n # Users receives the error message \"Something has gone wrong Atlassian account\".\r\n\r\nh3. Workaround\r\n # Use another browser\r\n # Try cleaning cache and cookies on IE or edge\r\n # Lower the cookie security settings in the \"Privacy\" tab on the browser configurations section.\r\n # Add [https://id.atlassian.com|https://id.atlassian.com%2A/] to trusted sites on the \"Security\" tab under IE Internet Settings.\r\n # Enabling the Protected Mode to on in IE could mitigate the problem.\r\n\r\nPlease note that the workaround options 2,3,4,5 might not work.",
    "reporterName": "Daniel Brito",
    "creationDate": "2017-04-07",
    "comments": []
  },
  {
    "summary": "Back button in browser with anchor links behaves incorrectly",
    "key": "CONFSERVER-52497",
    "uri": "https://jira.atlassian.com/rest/api/latest/issue/804382",
    "type": "Bug",
    "priority": "Low",
    "description": "h3. Summary\r\nBack button in browser does not return to previous page when using URL with anchor link\r\n\r\nh3. Environment\r\n* Any browser\r\n* Confluence 6.2.1\r\n\r\nh3. Steps to Reproduce\r\n# Create Page A with content that scrolls beyond the bottom of the screen, with several headings in the content that also go below the fold\r\n# Add a table of content macro at the top of Page A\r\n# Create Page B and insert *Web Links* with anchors from the table of contents to point to headings on Page A after the fold, for example\r\n#* http://confluence.mycompany.com/display/CONF/PageA#HeadingSix\r\n# Save Page B\r\n# Click on the link to go to Page A with the anchor\r\n# Click the back button in the broswer\r\n\r\nh3. Expected Results\r\nThe browser goes back to page\r\n\r\nh3. Actual Results\r\nYou need to click twice to return to the previous page\r\n \r\nh3.Workaround\r\nThere is no workaround at this time.",
    "reporterName": "James Richards",
    "creationDate": "2017-05-30",
    "comments": []
  },
  {
    "summary": "Unable to start the plugin container for plugin \u0027com.atlassian.upm.plugin-license-storage-plugin\u0027 after upgrade to Confluence 6.x",
    "key": "CONFSERVER-51958",
    "uri": "https://jira.atlassian.com/rest/api/latest/issue/673594",
    "type": "Bug",
    "priority": "High",
    "description": "h3. Steps to reproduce\r\n # Install Confluence 5.x;\r\n # Upgrade \"Atlassian Universal Plugin Manager - Plugin License Storage plugin\";\r\n # Upgrade Confluence to 6.x;\r\n\r\n*Expected results*\r\n\r\nNo errors are thrown.\r\n\r\n*Actual results*\r\n{noformat:title\u003datlassian-confluence.log}\r\n2017-03-16 17:07:07,764 ERROR [ThreadPoolAsyncTaskExecutor::Thread 24] [plugin.osgi.factory.OsgiPlugin] onPluginContainerFailed Unable to start the plugin container for plugin \u0027com.atlassian.upm.plugin-license-storage-plugin\u0027\r\n -- referer: https://wiki.wiki.com/plugins/servlet/upm/manage/all | url: /rest/plugins/1.0/com.atlassian.upm.plugin-license-storage-plugin-key | traceId: 1fe445b981f47ecc | userName: billy\r\norg.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name \u0027licenseReceiptValidator\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 0 of type [com.atlassian.upm.license.internal.PluginLicenseRepository]: Error creating bean with name \u0027pluginLicenseRepository\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 0 of type [com.atlassian.upm.license.internal.HostLicenseProvider]: Error creating bean with name \u0027confluenceHostLicenseProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name \u0027confluenceHostLicenseProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name \u0027pluginLicenseRepository\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 0 of type [com.atlassian.upm.license.internal.HostLicenseProvider]: Error creating bean with name \u0027confluenceHostLicenseProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name \u0027confluenceHostLicenseProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder\r\n\tat org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:749)\r\n\tat org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:185)\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1143)\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1046)\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:510)\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)\r\n\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)\r\n\tat org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)\r\n\tat org.eclipse.gemini.blueprint.context.support.AbstractDelegatedExecutionApplicationContext.access$1600(AbstractDelegatedExecutionApplicationContext.java:60)\r\n\tat org.eclipse.gemini.blueprint.context.support.AbstractDelegatedExecutionApplicationContext$4.run(AbstractDelegatedExecutionApplicationContext.java:325)\r\n\tat org.eclipse.gemini.blueprint.util.internal.PrivilegedUtils.executeWithCustomTCCL(PrivilegedUtils.java:85)\r\n\tat org.eclipse.gemini.blueprint.context.support.AbstractDelegatedExecutionApplicationContext.completeRefresh(AbstractDelegatedExecutionApplicationContext.java:290)\r\n\tat org.eclipse.gemini.blueprint.extender.internal.dependencies.startup.DependencyWaiterApplicationContextExecutor$CompleteRefreshTask.run(DependencyWaiterApplicationContextExecutor.java:137)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\r\n\tat java.lang.Thread.run(Thread.java:745)\r\nCaused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name \u0027pluginLicenseRepository\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 0 of type [com.atlassian.upm.license.internal.HostLicenseProvider]: Error creating bean with name \u0027confluenceHostLicenseProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name \u0027confluenceHostLicenseProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder\r\n\tat org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:749)\r\n\tat org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:185)\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1143)\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1046)\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:510)\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)\r\n\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:1192)\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1116)\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1014)\r\n\tat org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:813)\r\n\tat org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:741)\r\n\t... 19 more\r\nCaused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name \u0027confluenceHostLicenseProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder\r\n\tat org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:749)\r\n\tat org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:185)\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1143)\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1046)\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:510)\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)\r\n\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:1192)\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1116)\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1014)\r\n\tat org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:813)\r\n\tat org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:741)\r\n\t... 33 more\r\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1105)\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1050)\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:510)\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)\r\n\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:1192)\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1116)\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1014)\r\n\tat org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:813)\r\n\tat org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:741)\r\n\t... 47 more\r\nCaused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder\r\n\tat org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:163)\r\n\tat org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:89)\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1098)\r\n\t... 59 more\r\nCaused by: java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder\r\n\tat com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl.\u003cinit\u003e(LicenseManagerProviderImpl.java:40)\r\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\r\n\tat org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:147)\r\n\t... 61 more\r\n2017-03-16 17:07:17,795 ERROR [ThreadPoolAsyncTaskExecutor::Thread 24] [internal.util.concurrent.RunnableTimedExecution] execute Closing runnable for context NonValidatingOsgiBundleXmlApplicationContext(bundle\u003dcom.atlassian.upm.plugin-license-storage-plugin, config\u003dosgibundle:/META-INF/spring/*.xml) did not finish in 10000ms; consider taking a snapshot and then shutdown the VM in case the thread still hangs\r\n -- referer: https://wiki.wiki.com/plugins/servlet/upm/manage/all | url: /rest/plugins/1.0/com.atlassian.upm.plugin-license-storage-plugin-key | traceId: 1fe445b981f47ecc | userName: billy\r\n2017-03-16 17:07:17,842 WARN [ThreadPoolAsyncTaskExecutor::Thread 24] [confluence.util.profiling.DurationThresholdWarningTimingHelperFactory] logMessage Execution time for publishing event com.atlassian.plugin.event.events.PluginContainerFailedEvent@2ea04998 took 10077 ms (warning threshold is 5000 ms)\r\n -- referer: https://wiki.wiki.com/plugins/servlet/upm/manage/all | url: /rest/plugins/1.0/com.atlassian.upm.plugin-license-storage-plugin-key | traceId: 1fe445b981f47ecc | userName: billy\r\n2017-03-16 17:07:17,842 ERROR [ThreadPoolAsyncTaskExecutor::Thread 24] [extender.internal.support.ExtenderConfiguration] onOsgiApplicationEvent Application context refresh failed (NonValidatingOsgiBundleXmlApplicationContext(bundle\u003dcom.atlassian.upm.plugin-license-storage-plugin, config\u003dosgibundle:/META-INF/spring/*.xml))\r\n -- referer: https://wiki.wiki.com/plugins/servlet/upm/manage/all | url: /rest/plugins/1.0/com.atlassian.upm.plugin-license-storage-plugin-key | traceId: 1fe445b981f47ecc | userName: billy\r\norg.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name \u0027licenseReceiptValidator\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 0 of type [com.atlassian.upm.license.internal.PluginLicenseRepository]: Error creating bean with name \u0027pluginLicenseRepository\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 0 of type [com.atlassian.upm.license.internal.HostLicenseProvider]: Error creating bean with name \u0027confluenceHostLicenseProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name \u0027confluenceHostLicenseProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name \u0027pluginLicenseRepository\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 0 of type [com.atlassian.upm.license.internal.HostLicenseProvider]: Error creating bean with name \u0027confluenceHostLicenseProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name \u0027confluenceHostLicenseProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name \u0027licenseManagerProvider\u0027 defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder\r\n{noformat}\r\n!ss.png|thumbnail!\r\n\r\nWhen we upgrade a system plugin, Confluence handles it as \"User Installed\" and stores the data in the *PLUGINDATA* table. Since \u0027com.atlassian.upm.plugin-license-storage-plugin\u0027 has been unbundled from Confluence 6.x, it fails to load the *PLUGINDATA* entry.\r\n\r\n*Workaround*\r\n\r\n(!) Always backup the database before any changes.\r\n # Shutdown Confluence;\r\n # Ensure that there\u0027s an entry of this plugin in the PLUGINDATA table\r\n{code:sql}\r\nselect * from PLUGINDATA where PLUGINKEY\u003d\u0027com.atlassian.upm.plugin-license-storage-plugin\u0027;\r\n{code}\r\n # Delete the bad entry in PLUGINDATA  by executing the following DELETE statement:\r\n{code:sql}\r\ndelete from PLUGINDATA where PLUGINKEY\u003d\u0027com.atlassian.upm.plugin-license-storage-plugin\u0027;\r\n{code}\r\n\r\n # *[Clear Confluence plugin cache|https://confluence.atlassian.com/display/CONFKB/How+to+clear+Confluence+plugins+cache]*;\r\n # Start Confluence;",
    "reporterName": "Lucas Machado",
    "creationDate": "2017-03-22",
    "comments": []
  },
  {
    "summary": "When Space XML Imports Fail, Partial Space Data is Left in the Database",
    "key": "CONFSERVER-31528",
    "uri": "https://jira.atlassian.com/rest/api/latest/issue/305808",
    "type": "Bug",
    "priority": "Medium",
    "description": "{panel:bgColor\u003d#e7f4fa}\n  *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-31528].\n  {panel}\n\nSpace XML imports will sometimes fail due to a variety of reasons:\r\n* Confluence runs out of memory\r\n* The import process times out\r\n* Unique key constraint violations\r\n* A few other causes are described in https://confluence.atlassian.com/display/DOC/Troubleshooting+XML+backups+that+fail+on+restore\r\n\r\nOftentimes these partially imported spaces remain in the DB without any way to remove them via the UI, making a re-import attempt impossible (due to a duplicate Space Key or other constraint violation).\r\n\r\nCan we investigate:\r\n- some way to rollback a failed XML space import (or determine whether imports will fail before it starts)?\r\n- possibilities for Confluence to automatically recognise half-imported Spaces and delete related data from the UI?\r\n\r\n*Current workaround:* [How to Manually Delete a Space|https://confluence.atlassian.com/display/CONFKB/How+to+Manually+Delete+a+Space] (Cloud users will need to contact Atlassian Support and request removing the Space from Confluence database)",
    "reporterName": "Robert Chang",
    "creationDate": "2013-11-07",
    "comments": []
  },
  {
    "summary": "Users are Unable to Upload Attachments to Confluence Questions Posts",
    "key": "CONFCLOUD-55333",
    "uri": "https://jira.atlassian.com/rest/api/latest/issue/806914",
    "type": "Bug",
    "priority": "Low",
    "description": "h3. Summary\r\nSome users are unable to upload file attachments to Confluence Questions posts either during Creation, Commenting, or when Providing an Answer. \r\n\r\nh3. Environment\r\n* Cloud -  \r\n\r\nh3. Steps to Reproduce\r\nAs a Non-Admin User: \r\n# Login to Confluence and ask a New Confluence Question\r\n# Attempt to add an Attachment to your Question (via Upload or Drag and Drop)\r\n\r\nOr:\r\n# View an existing Confluence Question\r\n# Add an Answer or Comment and try to upload an Attachment (via Upload or Drag and Drop)\r\n\r\nh3. Expected Results\r\nAttachment is added to the Question/Answer/Comment\r\n\r\nh3. Actual Results\r\nBrowser Developer Console shows a 403 Error when the user tries to upload the file\r\n{noformat}POST https://INSTANCE.atlassian.net/wiki/rest/drag-and-drop/1/filestore/upload/validate 403 ()\r\n(anonymous)\r\nXMLHttpRequest.send @ batch.js?acjsFiveVersionEnabled\u003dtrue\u0026build-number\u003d6452\u0026locale\u003den-GB:2049\r\nsend @ jquery-min.js:3\r\najax @ jquery-min.js:3\r\nd.filesAdded @ /wiki/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-2083900483/h/a04171f99aeb0f79…der/com.atlassian.confluence.plugins.drag-and-drop:filestore-uploader.js:7\r\nf @ /wiki/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-2083900483/h/2960a5637b7b3bfe…onfluence.plugins.drag-and-drop:drag-and-drop-for-editor.js?locale\u003den-GB:7\r\nfilterFiles @ com.atlassian.confluence.plugins.drag-and-drop:upload-utils.js:6\r\n(anonymous) @ /wiki/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-2083900483/h/2960a5637b7b3bfe…onfluence.plugins.drag-and-drop:drag-and-drop-for-editor.js?locale\u003den-GB:9\r\ntrigger @ /wiki/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-2083900483/h/7047bd2ac58f8bf4…/confluence.web.resources:plupload/confluence.web.resources:plupload.js:23\r\n(anonymous) @ /wiki/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-2083900483/h/0f450b38f8ab880b…an.confluence.plugins.drag-and-drop:default-drop-handler.js?locale\u003den-GB:9\r\ntrigger @ /wiki/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-2083900483/h/7047bd2ac58f8bf4…/confluence.web.resources:plupload/confluence.web.resources:plupload.js:23\r\nk @ /wiki/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-2083900483/h/7047bd2ac58f8bf4…/confluence.web.resources:plupload/confluence.web.resources:plupload.js:47\r\n(anonymous) @ /wiki/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-2083900483/h/7047bd2ac58f8bf4…/confluence.web.resources:plupload/confluence.web.resources:plupload.js:53\r\nbatch.js:111 AJS\u0027s create element functionality has been deprecated since 5.9.0.\r\nNo alternative will be provided.\r\nUse document.createElement() or jQuery.parseHTML(), or preferably use a templating library.\r\na.default @ batch.js:111\r\na @ batch.js:467\r\nb @ batch.js:787\r\nf.show @ batch.js:804\r\nshow @ /wiki/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-2083900483/h/5cd471106529f157….confluence.plugins.drag-and-drop:upload-progress-dialog.js?locale\u003den-GB:7\r\n(anonymous) @ /wiki/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-2083900483/h/2960a5637b7b3bfe…onfluence.plugins.drag-and-drop:drag-and-drop-for-editor.js?locale\u003den-GB:8\r\nd @ jquery-min.js:1\r\nfireWith @ jquery-min.js:1\r\nfire @ jquery-min.js:1\r\n(anonymous) @ /wiki/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-2083900483/h/a04171f99aeb0f79…der/com.atlassian.confluence.plugins.drag-and-drop:filestore-uploader.js:7\r\nd @ jquery-min.js:1\r\nfireWith @ jquery-min.js:1\r\nr @ jquery-min.js:3\r\nr @ jquery-min.js:3{noformat}\r\n\r\nThe UI shows a message stating:\r\n{quote}You\u0027ll need to ask permissions to insert files here. {quote}\r\n \r\nh3. Notes\r\n- Tested with Confluence Questions Posts both Linked and Not-Linked to Spaces within the Instance; same message appears \r\n- On the Confluence Question Post that was linked to a Space, the User is a Space Admin and has permissions to Add Attachments\r\n\r\nh3.Workaround\r\nAdd the Attachment to a Confluence Page or other file sharing site and link to the Page on the Confluence Questions Post",
    "reporterName": "Shawn Cranford",
    "creationDate": "2017-06-08",
    "comments": []
  }
]